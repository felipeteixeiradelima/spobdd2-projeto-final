{% extends "core/base.html" %}
{% block title %}Doações{% endblock %}

{% block content %}
<div class="container py-5 mt-5">
    <section class="container m-auto bg-light">

        <!-- HEADER -->
        <header class="text-center mb-5">
            <h1 class="text-danger fw-bold">
                <i class="bi bi-heart-pulse"></i> Doações
            </h1>
            <p class="lead">Gerencie todas as doações registradas no sistema.</p>
        </header>

        <!-- BOTÃO NOVA DOAÇÃO -->
        <div class="d-flex justify-content-end mb-3">
            <a href="{% url 'doacao_create' %}" class="btn btn-danger mb-3 float-end">
                <i class="bi bi-plus-circle"></i> Registrar Doação
            </a>
        </div>

        <!-- CARD PRINCIPAL -->
        <article class="bg-white p-4 rounded shadow-sm">
            <h2 class="h4 text-danger mb-3">
                <i class="bi bi-clipboard-heart"></i> Lista de Doações
            </h2>

            <div class="table-responsive">
                <table id="doacoesTable" class="table table-striped table-hover align-middle text-center">
                    <thead class="table-danger">
                        <tr>
                            <th>ID</th>
                            <th>Doador</th>
                            <th>Data</th>
                            <th>Campanha</th>
                            <th>Ponto</th>
                            <th>Amostra</th>
                            <th>Ações</th>
                        </tr>
                    </thead>

                    <tbody>
                        {% for d in doacoes %}
                        <tr>
                            <td>{{ d.id_doacao }}</td>
                            <td>{{ d.doador.nome }}</td>
                            <td>{{ d.data_doacao|date:"d/m/Y" }}</td>
                            <td>{% if d.campanha %} {{ d.campanha.nome }} {% else %}-{% endif %}</td>
                            <td>{% if d.ponto %} {{ d.ponto.nome }} {% else %}-{% endif %}</td>

                            <td>
                                {% if d.amostra %}
                                    <span class="badge bg-success">
                                        #{{ d.amostra.id_amostra }}
                                    </span>
                                {% else %}
                                    <span class="text-muted">(nenhuma)</span>
                                {% endif %}
                            </td>

                            <td>
                                <a href="{% url 'doacao_detail' d.id_doacao %}" class="btn btn-outline-danger btn-sm">
                                    <i class="bi bi-search"></i>
                                </a>
                                <a href="{% url 'doacao_edit' d.id_doacao %}" class="btn btn-outline-primary btn-sm">
                                    <i class="bi bi-pencil-square"></i>
                                </a>
                                <a href="{% url 'doacao_delete' d.id_doacao %}" class="btn btn-outline-dark btn-sm">
                                    <i class="bi bi-trash"></i>
                                </a>
                            </td>
                        </tr>

                        {% empty %}
                        <tr>
                            <td colspan="0"></td>
                            <td colspan="0"></td>
                            <td colspan="0"></td>
                            <td colspan="0" class="text-center text-muted py-3">Nenhuma doação registrada.</td>
                            <td colspan="0"></td>
                            <td colspan="0"></td>
                            <td colspan="0"></td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </article>

    </section>
</div>
{% endblock %}
